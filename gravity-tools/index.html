# Generate digital-art assets from the user's three images and an updated hub HTML
from PIL import Image, ImageFilter, ImageDraw, ImageOps
import os, zipfile, io, math, textwrap

# Source images (already uploaded)
src1 = "/mnt/data/art14.jpg"       # square cyborg + butterfly
src2 = "/mnt/data/art2.jpg"        # wide cyborg + butterfly (good for hero + crypto)
src3 = "/mnt/data/background.jpg"  # neon brain (portrait)

assets_dir = "/mnt/data/gravity-tools-assets"
os.makedirs(assets_dir, exist_ok=True)

def make_canvas(w,h,color=(7,10,15)):
    img = Image.new("RGB", (w,h), color)
    return img

def fit_cover(img, size):
    # cover like CSS: center crop
    return ImageOps.fit(img, size, method=Image.LANCZOS, centering=(0.5,0.5))

def darken(img, alpha=0.35):
    overlay = Image.new("RGB", img.size, (0,0,0))
    return Image.blend(img, overlay, alpha)

def vignette(img, strength=0.4):
    w,h = img.size
    mask = Image.new('L', (w,h), 0)
    draw = ImageDraw.Draw(mask)
    # radial gradient ellipse
    max_r = int((w**2 + h**2)**0.5/2)
    for r in range(max_r, 0, -10):
        a = int(255 * (1 - (r/max_r))**1.5 * strength)
        bbox = (w//2 - r, h//2 - r, w//2 + r, h//2 + r)
        draw.ellipse(bbox, fill=a)
    blur = mask.filter(ImageFilter.GaussianBlur(60))
    # composite
    black = Image.new('RGB', (w,h), (0,0,0))
    return Image.composite(black, img, ImageOps.invert(blur))

def save(img, path_jpg, quality=88):
    img.save(path_jpg, "JPEG", quality=quality, optimize=True, progressive=True)

# Load sources
img1 = Image.open(src1).convert("RGB")
img2 = Image.open(src2).convert("RGB")
img3 = Image.open(src3).convert("RGB")

# 1) Hero background (1920x1080) from img2 with blur + vignette
hero = fit_cover(img2, (1920,1080)).filter(ImageFilter.GaussianBlur(1.2))
hero = darken(hero, 0.15)
hero = vignette(hero, 0.55)
hero_path = os.path.join(assets_dir, "bg_hero.jpg")
save(hero, hero_path)

# 2) Tile images (1200x800)
tile_crypto = fit_cover(img2, (1200,800))
tile_crypto = darken(tile_crypto, 0.10)
save(tile_crypto, os.path.join(assets_dir, "tile_crypto.jpg"))

tile_proxy = fit_cover(img1, (1200,800))
tile_proxy = darken(tile_proxy, 0.10)
save(tile_proxy, os.path.join(assets_dir, "tile_proxy.jpg"))

tile_ai = fit_cover(img3, (1200,800))
tile_ai = darken(tile_ai, 0.08)
save(tile_ai, os.path.join(assets_dir, "tile_ai.jpg"))

# Also generate lightweight thumbnails for faster grid previews
thumbs_dir = os.path.join(assets_dir, "thumbs")
os.makedirs(thumbs_dir, exist_ok=True)
for name in ["tile_crypto","tile_proxy","tile_ai"]:
    im = Image.open(os.path.join(assets_dir, name + ".jpg")).copy()
    im.thumbnail((800,533), Image.LANCZOS)
    im.save(os.path.join(thumbs_dir, name + "_800.jpg"), "JPEG", quality=85, optimize=True, progressive=True)

# 3) Updated hub HTML that uses these assets
html_path = "/mnt/data/gravity-tools_index_digital_with_bg.html"
html = f"""<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Gravity-Zone Tools ‚Äî Neon Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {{
      theme: {{
        extend: {{
          fontFamily: {{ sans: ['Inter','ui-sans-serif','system-ui'] }},
          colors: {{ ink:'#0a0d12', glass:'#0e1320', hint:'#b8c2d9', neon:'#ff7a18', neon2:'#8a2be2' }},
          boxShadow: {{ glass: '0 10px 30px rgba(0,0,0,.35)' }}
        }}
      }}
    }}
  </script>
  <style>
    html,body{{height:100%;background:#070a0f}}
    .hero-img{{background-image:linear-gradient(to bottom,rgba(7,10,15,.35),rgba(7,10,15,.75)), url('./assets/bg_hero.jpg');background-size:cover;background-position:center;}}
    .card-bg{{background-size:cover;background-position:center;position:relative;overflow:hidden}}
    .card-bg:before{{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(14,19,32,.35),rgba(14,19,32,.65));}}
    .card-content{{position:relative}}
    .card:hover{{transform:translateY(-4px)}}
  </style>
</head>
<body class="font-sans text-white antialiased">

  <!-- Header -->
  <header class="max-w-6xl mx-auto px-4 pt-6">
    <div class="flex items-center justify-between gap-3 rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-3 sm:p-4 shadow-glass">
      <div class="flex items-center gap-3">
        <div class="size-11 rounded-xl bg-gradient-to-br from-neon to-neon2 shadow-[0_0_30px_rgba(255,122,24,.35)]"></div>
        <div>
          <h1 class="text-xl sm:text-2xl font-extrabold tracking-tight">Gravity-Zone Tools</h1>
          <p class="text-hint text-xs sm:text-sm">Creator stack ‚Ä¢ fast ‚Ä¢ neon ‚Ä¢ crisp</p>
        </div>
      </div>
      <div class="hidden sm:flex items-center gap-2">
        <span class="px-3 py-1.5 rounded-full text-xs border border-white/10 bg-white/5">v1 ‚Ä¢ Neon Hub</span>
        <a class="px-3 py-1.5 rounded-full text-xs border border-neon/40 text-neon hover:bg-neon hover:text-black transition"
           href="../tools/ai/">AI Quick Chat</a>
      </div>
    </div>
  </header>

  <!-- Hero with background -->
  <section class="max-w-6xl mx-auto px-4 mt-6">
    <div class="hero-img rounded-2xl border border-white/10 backdrop-blur-xl p-6 sm:p-8 shadow-glass relative overflow-hidden">
      <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-6">
        <div>
          <div class="inline-flex items-center gap-2 text-xs text-hint mb-2">
            <span class="size-2 rounded-full bg-emerald-400 animate-pulse"></span>
            Live toolkit hub
          </div>
          <h2 class="text-2xl sm:text-3xl font-extrabold tracking-tight">All your tools, one neon hub</h2>
          <p class="text-hint mt-2 max-w-2xl">Crypto first, Proxy second ‚Äî then AI, Translate, Touch, Gallery, Music.</p>
        </div>
        <div class="flex items-center gap-3">
          <a href="../tools/crypto/" class="px-4 py-2 rounded-xl font-extrabold bg-neon text-black shadow-[0_8px_24px_rgba(255,122,24,.35)]">Open Crypto</a>
          <a href="../tools/proxy/" class="px-4 py-2 rounded-xl font-extrabold border border-neon/60 text-neon hover:bg-neon hover:text-black transition">Proxy Zone</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Grid -->
  <main class="max-w-6xl mx-auto px-4 mt-6 mb-10">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">

      <!-- 1) Crypto -->
      <article class="card card-bg rounded-2xl border border-white/10 shadow-glass p-5" style="background-image:url('./assets/thumbs/tile_crypto_800.jpg')">
        <div class="card-content">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-extrabold">ü™ô Crypto News & Airdrops</h3>
            <span class="text-[10px] px-2 py-1 rounded-full bg-emerald-500/15 border border-emerald-500/30 text-emerald-300">auto-refresh</span>
          </div>
          <p class="text-white/80 text-sm mt-2 max-w-md">Curated feeds, 15-min refresh, action ideas.</p>
          <div class="mt-4 flex items-center gap-2">
            <a class="inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-neon text-black font-extrabold" href="../tools/crypto/">Open ‚Üí</a>
            <a class="text-white/80 text-xs underline underline-offset-4 hover:text-white" href="../tools/crypto/">Details</a>
          </div>
        </div>
      </article>

      <!-- 2) Proxy -->
      <article class="card card-bg rounded-2xl border border-white/10 shadow-glass p-5" style="background-image:url('./assets/thumbs/tile_proxy_800.jpg')">
        <div class="card-content">
          <h3 class="text-lg font-extrabold">üîê Free Proxy For All</h3>
          <p class="text-white/80 text-sm mt-2">Stable, auto-generated proxies. Copy & go.</p>
          <div class="mt-4">
            <a class="px-3 py-2 rounded-xl bg-transparent border border-neon/60 text-neon hover:bg-neon hover:text-black font-extrabold transition" href="../tools/proxy/">Get Proxy</a>
          </div>
        </div>
      </article>

      <!-- 3) AI Chat -->
      <article class="card card-bg rounded-2xl border border-white/10 shadow-glass p-5" style="background-image:url('./assets/thumbs/tile_ai_800.jpg')">
        <div class="card-content">
          <h3 class="text-lg font-extrabold">üß† AI Chat ‚Äî 2 Models</h3>
          <p class="text-white/80 text-sm mt-2">LLaMA / GPT. 10+ languages. Switch on the fly.</p>
          <div class="mt-4"><a class="px-3 py-2 rounded-xl bg-neon text-black font-extrabold" href="../tools/ai/">Start Chat</a></div>
        </div>
      </article>

      <!-- 4) Translate -->
      <article class="card rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-5 shadow-glass">
        <h3 class="text-lg font-extrabold">üó£ Translate (FA / EN / AR / RU / TR)</h3>
        <p class="text-hint text-sm mt-2">Bi-directional, voice‚Üîtext, text-to-speech.</p>
        <div class="mt-4"><a class="px-3 py-2 rounded-xl bg-transparent border border-neon/60 text-neon hover:bg-neon hover:text-black font-extrabold transition" href="../tools/translate/">Translate</a></div>
      </article>

      <!-- 5) Touch -->
      <article class="card rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-5 shadow-glass">
        <h3 class="text-lg font-extrabold">üé® Touch the Visual Color</h3>
        <p class="text-hint text-sm mt-2">Finger gestures + reactive visuals + music.</p>
        <div class="mt-4"><a class="px-3 py-2 rounded-xl bg-neon text-black font-extrabold" href="../tools/touch/">Open</a></div>
      </article>

      <!-- 6) Gallery -->
      <article class="card rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-5 shadow-glass">
        <h3 class="text-lg font-extrabold">üñºÔ∏è Gallery / NFT</h3>
        <p class="text-hint text-sm mt-2">Fullscreen slider. Crisp. Fast.</p>
        <div class="mt-4"><a class="px-3 py-2 rounded-xl bg-transparent border border-neon/60 text-neon hover:bg-neon hover:text-black font-extrabold transition" href="../tools/gallery/">View</a></div>
      </article>

      <!-- 7) Music -->
      <article class="card rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-5 shadow-glass">
        <h3 class="text-lg font-extrabold">üéß Music Mini-App</h3>
        <p class="text-hint text-sm mt-2">Local player + Spotify embed ready.</p>
        <div class="mt-4"><a class="px-3 py-2 rounded-xl bg-neon text-black font-extrabold" href="../tools/music/">Open</a></div>
      </article>

    </div>
  </main>

  <footer class="max-w-6xl mx-auto px-4 pb-10">
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-4 text-center text-hint text-xs">
      ¬© Gravity-Zone ‚Ä¢ Neon mode ‚Ä¢ GitHub Pages
    </div>
  </footer>
</body>
</html>
"""
with open(html_path, "w", encoding="utf-8") as f:
    f.write(html)

# Zip assets + html for easy download
zip_out = "/mnt/data/gz_neon_assets_and_index.zip"
with zipfile.ZipFile(zip_out, "w", zipfile.ZIP_DEFLATED) as z:
    # add html
    z.write(html_path, "gravity-tools/index.html")
    # add assets
    for base, _, files in os.walk(assets_dir):
        for name in files:
            full = os.path.join(base, name)
            arc = os.path.relpath(full, assets_dir)
            z.write(full, f"gravity-tools/assets/{arc}")
zip_out
